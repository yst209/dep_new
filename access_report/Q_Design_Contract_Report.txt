SELECT Q_Cobra_Budget_Info.Resource, dbo_P6_Historical_Trend.Project_ID, dbo_P6_Historical_Trend.Project_Name, dbo_P6_Historical_Trend.Current_Status, dbo_P6_Historical_Trend.Current_Stage, dbo_P6_Historical_Trend.Data_Date, dbo_P6_Historical_Trend.Accountable_Design_Manager, dbo_P6_Historical_Trend.Accountable_Construction_Manager, dbo_P6_Historical_Trend.Portfolio_Manager, Q_Cobra_Budget_Info.PType, Q_Cobra_Budget_Info.[Cost Set], Q_Cobra_Budget_Info.Value, dbo_P6_Historical_Trend.Master_Program
FROM (dbo_P6_Historical_Trend LEFT JOIN Q_Cobra_Budget_Info ON dbo_P6_Historical_Trend.Project_ID = Q_Cobra_Budget_Info.WBS) INNER JOIN Q_P6_Latest_Data_Period ON dbo_P6_Historical_Trend.Data_Period = Q_P6_Latest_Data_Period.LatestDataPeriod
WHERE (((dbo_P6_Historical_Trend.Project_ID) Not Like '*B1*' And (dbo_P6_Historical_Trend.Project_ID) Not Like '*B2*') AND ((Q_Cobra_Budget_Info.[Cost Set])<>'BCWP'))
ORDER BY Q_Cobra_Budget_Info.Resource, dbo_P6_Historical_Trend.Project_ID, Q_Cobra_Budget_Info.PType;
